# 简介

Surge的核心功能是由配置文件控制的。基本上，配置文件的所有内容都可以由用户界面调整。但是一些实验性的功能可能还没有配置的视图。当你遇到一些特殊要求时，你可能需要手动编辑配置文件来实现它。

### 简介内容

配置文件的格式遵循INI文件的格式，有[Section]段，用来划分不同的段落和分隔设置。

每个部分的配置行都有自己特定的语法，比如[General]、[Replica]和[MITM]部分只是采用了key = value的格式

```
[General]
key = value
```

在这些段落中，配置行的顺序没有影响。然而，在[Rule]等段落中，配置行的上下顺序是非常重要的。


### 配置文件的分类

配置文件分为三类。
1.普通配置文件：手动创建或默认使用。
2.被管理的配置文件：通常由企业管理员或服务提供商提供。被管理的配置文件不能在本地修改，因为它可以被远程更新。如果你想进行修改，你应该首先创建一个副本，将其转移到正常配置中。
3.企业配置文件：只有企业版，不能修改或查看，也不能复制。


### 分离式配置文件部分

为了满足各种使用场景的复杂性，Surge Mac 4.1.0 Beta / Surge iOS Beta 1903开始支持将配置文件的一个部分分离到另一个文件。

比如说。

Main.conf
```
[Proxy]
#!include Proxy.dconf
```

其中引用的其他文件必须包含相应章节的[]声明。因此，该文件既可以是一个只包含部分章节（一个或多个）的文件，也可以是一个完整的配置。

Proxy.dconf
```
[Proxy]
ProxyA = http, 1.2.3.4, 80
```

使用这个函数，你可以
1.引用管理配置中的[Proxy]、[Proxy Group]、[Rule]段落，并自己编写其他段落。这可以让你享受管理配置的代理相关内容更新，而不影响通过用户界面调整的其他功能。
2.在多个配置之间共享某些段落的内容。例如，在iOS和macOS上使用Surge时，[Proxy]、[Proxy Group]、[Rule]等部分的内容往往是相同的，但[General]的内容可能有很大不同。你可以创建两个配置，iOS.conf和macOS.conf，并将重复的部分放在另一个文件中。

```
[Proxy]
#!include Forwarding.dconf

[Proxy Group]
#!include Forwarding.dconf

[Rule]
#!include Forwarding.dconf
```

这样，在iOS上调整[General]部分时，不会影响到macOS，避免了维护两套代理配置的麻烦。它也完全不会干扰到使用UI的配置。

一些补充说明。
- 通过UI修改配置后，根据include语句，配置文件被写入相应的分离式配置文件。如果文件包含其他不使用的部分，写入时将只修改使用的部分。
- 如果引用了一个被管理的配置文件，与该部分相关的配置不能被编辑，但不影响对其他部分的调整。
- 文件名后缀不是必须的，如果是完整的配置文件，可以继续使用conf后缀，如果不是完整的配置文件，建议使用其他后缀，以免在配置列表中被显示。
- 从Surge iOS 4.12.0 & Surge Mac 4.5.0开始，你可以在一个部分包含多个分离的配置文件。但该部分将被标记为只读，不能用用户界面进行编辑。

    ```
    [Proxy]
    #!include A.dconf, B.dconf
    ```



### 模块

分离的配置文件部分功能用于将一个配置文件分割成多个文件，而模块是配置文件的补丁，每个模块文件用于调整配置文件的各个部分以实现特定的任务。

模块可以是：
- 灵活地开启和关闭。
- 在同一文件中对多个部分进行调谐。
- 通过URL安装并保持更新。

但是
- 模块不能调整[Proxy]、[Proxy Group]、[Rule]部分的内容。
- 模块不能调整MITM的CA证书。
- 模块的设置覆盖了主配置文件，所以不能通过用户界面调整。

该模块的描述见：https://manual.nssurge.com/others/module.html


### 评论

Surge配置文件支持注释行，以`#`、`;`和`//`开头。内联评论也支持用`//`分隔。